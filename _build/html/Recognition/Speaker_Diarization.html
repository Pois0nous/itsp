
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Speaker Diarization &#8212; Introduction to Speech Processing</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Introduction to Speech Processing</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Introduction to Speech Processing
  </a>
 </li>
</ul>
    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Recognition/Speaker_Diarization.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-to-speaker-diarization">
   1. Introduction to Speaker Diarization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#approaches-to-speaker-diarization">
   2. Approaches to Speaker Diarization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation-metrics">
   3. Evaluation Metrics
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Speaker Diarization</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-to-speaker-diarization">
   1. Introduction to Speaker Diarization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#approaches-to-speaker-diarization">
   2. Approaches to Speaker Diarization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation-metrics">
   3. Evaluation Metrics
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="speaker-diarization">
<h1>Speaker Diarization<a class="headerlink" href="#speaker-diarization" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction-to-speaker-diarization">
<h2>1. Introduction to Speaker Diarization<a class="headerlink" href="#introduction-to-speaker-diarization" title="Permalink to this headline">¶</a></h2>
<p>Speaker diarization is the process of segmenting and clustering a speech
recording into homogeneous regions and answers the question “who spoke
when” without any prior knowledge about the speakers. A typical
diarization system performs three basic tasks. Firstly, it discriminates
speech segments from the non-speech ones. Secondly, it detects speaker
change points to segment the audio data. Finally, it groups these
segmented regions into speaker homogeneous clusters.</p>
<p>An overview of a speaker diarization system.</p>
<p>Although there are many different approaches to perform speaker
diarization, most of them follow the following scheme:</p>
<p>Feature extraction: It extracts specific information from the audio
signal and allows subsequent speaker modeling and classification. The
extracted features should ideally maximize inter-speaker variability and
minimize intra-speaker variability, and represent the relevant
information.</p>
<p>Speaker segmentation: It partitions the audio data into acoustically
homogeneous segments according to speaker identities. It detects all
boundary locations within each speech region that corresponds to speaker
change points which are subsequently used for speaker clustering.</p>
<p>Speaker clustering: Speaker clustering groups speech segments that
belong to a particular speaker. It has two major categories based on its
processing requirements. Its two main categories are online and offline
speaker clustering. In the former, speech segments are merged or split
in consecutive iterations until the optimum number of speakers is
acquired. Since the entire speech file is available before decision
making in the later, it provides better results more than the online
speaker clustering. The most widely used and popular technique for
speaker clustering is Agglomerative Hierarchical Clustering (AHC). AHC
builds a hierarchy of clusters, that shows the relations between speech
segments, and merges speech segments based on similarity. AHC approaches
can be classified into bottom-up and top-down clustering.</p>
<p>Two items need to be defined in both bottom-up and top-down clustering:</p>
<p>1. A distance between speech segments to determine acoustic similarity.
The distance metric is used to decide whether or not two clusters must
be merged (bottom-up clustering) or split (top-down clustering).</p>
<p>2. A stopping criterion to determine when the optimal number of
clusters (speakers) is reached.</p>
<p>Bottom-up (Agglomerative): It starts from a large number of speech
segments and merges the closest speech segments iteratively until a
stopping criterion is met. This technique is the most widely used in
speaker diarization since it is directly applied on the output of speech
segments from speaker segmentation. A matrix of distances between every
possible pair of clusters is computed and the pair with highest BIC
value is merged. Then, the merged clusters are removed from the distance
matrix. Finally, the distance matrix table is updated using the
distances between the new merged cluster and all remaining clusters.
This process is done iteratively until the stopping criterion is met or
all pairs have a BIC value less than zero .</p>
<p>Top-down: Top-down Hierarchical Clustering methods start from a small
number of clusters, usually a single cluster that contains several
speech segments, and the initial clusters are split iteratively until a
stopping criterion is met. It is not as widely used as the bottom-up
clustering.</p>
<p>Bottom-Up and Top-down approaches to clustering</p>
</div>
<div class="section" id="approaches-to-speaker-diarization">
<h2>2. Approaches to Speaker Diarization<a class="headerlink" href="#approaches-to-speaker-diarization" title="Permalink to this headline">¶</a></h2>
<p>This section describes some of the state-of-the-art speaker diarization
systems.</p>
<p>HMM/GMM based speaker diarization system: Each speaker is represented by
a state of an HMM and the state emission probabilities are modeled using
GMMs. The initial clustering is performed initially by partitioning the
audio signal equally which generates a set of segments { \( s_i \) }.
Let  \( c_i \) represent  \( i^{th} \) speaker cluster,  \( b_i \)
represent the emission probability of cluster  \( c_i \) and  \( f_t
\) denote a given feature vector at time \( t \) . Then, the
log-likelihood  \( logb_i(s_t) \) of the feature ft for cluster  \(
c_i \) is calculated as follows:</p>
<p>\[ logb_i(s_t)=log \sum_{(r)} {w}^r_i N
(f_i,{\mu}^r_i,\sum_{(i)}^r) \]</p>
<p>where  \( N() \) is a Gaussian pdf and  \( {w}^r_i,
{\mu}^r_i,\sum_{(i)}^r) \) are the weights, means and covariance
matrices of the  \( r^{th} \) Gaussian mixture component of cluster 
\( c_i \) , respectively.</p>
<p>The agglomerative hierarchical clustering starts by overestimating the
number of clusters. At each iteration, the clusters that are most
similar are merged based on the BIC distance. The distance measure is
based on modified delta Bayesian information criterion [Ajmera and
Wooters, 2003]. The modified BIC distance does not take into account
the penalty term that corresponds to the number of free parameters of a
multivariate Gaussian distribution and is expressed as:</p>
<p>\[ \Delta BIC (c_i,c_j)= log \sum_{f_t \in ( {ci \; \cup \;
c_j})} log b_{ij}(f_t) - log \sum_{f_t \in ci} log b_{i}(f_t) - log
\sum_{f_t \in cj} log b_{j}(f_t) \]</p>
<p>where  \( b_{ij} \) is the probability distribution of the combined
clusters  \( c_i \) and  \( c_j. \)</p>
<p>The clusters that produce the highest BIC score are merged at each
iteration. A minimum duration of speech segments is normally constrained
for each class to prevent decoding short segments. The number of
clusters is reduced at each iteration. When the maximum  \( \Delta BIC
\)</p>
<p>distance among these clusters is less than threshold value 0, the
speaker diarization system stops and outputs the hypothesis.</p>
<p>Factor analysis techniques: Factor analysis techniques which are the
state of the art in speaker recognition have recently been successfully
used in speaker diarization. The speech clusters are first represented
by i-vectors and the successive clustering stages are performed based on
i-vector modeling. The use of factor analysis technique to model speech
segments reduces the dimension of the feature vector by retaining most
of the relevant information. Once the speech clusters are represented by
i-vectors, cosine-distance and PLDA scoring techniques can be applied to
decide if two clusters belong to the same or different speaker(s).</p>
<p>Deep learning approaches: Speaker diarization is crucial for many speech
technologies in the presence of multiple speakers, but most of the
current methods that employ i-vector clustering for short segments of
speech are potentially too cumbersome and costly for the front-end role.
Thus, it has been proposed by Daniel Povey an alternative approach for
learning representations via deep neural networks to remove the i-vector
extraction process from the pipeline entirely. The proposed architecture
simultaneously learns a fixed-dimensional embedding for acoustic
segments of variable length and a scoring function for measuring the
likelihood that the segments originated from the same or different
speakers.  The proposed neural based system matches or exceeds the
performance of state-of-the-art baselines.</p>
</div>
<div class="section" id="evaluation-metrics">
<h2>3. Evaluation Metrics<a class="headerlink" href="#evaluation-metrics" title="Permalink to this headline">¶</a></h2>
<p>Diarization Error Rate (DER) is the metric used to measure the
performance of speaker diarization systems. It is measured as the
fraction of time that is not attributed correctly to a speaker or
non-speech.</p>
<p>The DER is composed of the following three errors:</p>
<p>Speaker Error: It is the percentage of scored time that a speaker ID is
assigned to the wrong speaker. Speaker error is mainly a diarization
system error (i.e., it is not related to speech/non-speech detection.)
It also does not take into account the overlap speeches not detected.</p>
<p>False Alarm: It is the percentage of scored time that a hypothesized
speaker is labelled as a non-speech in the reference. The false alarm
error occurs mainly due to the the speech/non-speech detection error
(i.e., the speech/non-speech detection considers a non-speech segment as
a speech segment). Hence, false alarm error is not related to
segmentation and clustering errors.</p>
<p>Missed Speech: It is the percentage of scored time that a hypothesized
non-speech segment corresponds to a reference speaker segment. The
missed speech occurs mainly due to the the speech/non-speech detection
error (i.e., the speech segment is considered as a non-speech segment).
Hence, missed speech is not related to segmentation and clustering
errors.</p>
<p>\[ DER = Speaker \; Error + False \; Alarm + Miss \; Speech \]</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Recognition"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Tom Bäckström, Okko Räsänen, Abraham Zewoudie, Pablo Pérez Zarazaga, Liisa Koivusalo, Sneha Das<br/>
    
      <div class="extra_footer">
        <p>
<img src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" style="border-width: 0;" alt="Creative Commons License" />
This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
</p>

      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>